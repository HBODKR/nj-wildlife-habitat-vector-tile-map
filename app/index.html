<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="NJ Wildlife Habitat Viewer">
    <title>NJ Wildlife Habitat Viewer</title>
    <link rel="shortcut icon" href="images/New-Jersey-favicon.png">
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <!-- Main stylesheet -->
    <link rel="stylesheet" href="css/main.css" />

    <!-- Mapbox GL JS -->
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.42.2/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.42.2/mapbox-gl.css' rel='stylesheet' />

    <!-- D3.js -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-queue.v3.min.js"></script>

    <!-- Turf.js -->
    <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/turf/v3.0.11/turf.min.js'></script>

    <!-- Mapbox GL JS Draw -->
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.0/mapbox-gl-draw.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.0/mapbox-gl-draw.css' type='text/css'/>

    <!-- Mapbox GL JS Geocoder -->
    <script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.1/mapbox-gl-geocoder.min.js'></script>
    <link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v2.1.1/mapbox-gl-geocoder.css' type='text/css' />

    <!-- Font Awesome icon library -->
    <script src="https://use.fontawesome.com/e1061b6f05.js"></script>
</head>
<body>
    <div class="grid">
        <!-- Header -->
        <div class="header">
            <div class="learn-more-btn">
                <a href="#" id="modal-btn" class="btn btn-blue">Learn more</a>
            </div>
            <div class="logo">
                <a href="http://www.azavea.com" target="_blank"><img src="images/azavea_rgb_solo.svg"></a>
                <p class="subtitle"> an Azavea R&amp;D Project</p>
            </div>
        </div>
        <!-- Header -->
        <!-- Title -->
        <div class="title">
            <h1>NJ Wildlife Habitat Viewer</h1>
        </div>
        <!-- Title -->
        <!-- Sidebar -->
        <sidebar>
            <!-- Geocoder -->
            <div class="block">
                <div id="geocoder-container" class="geocoder-container"></div>
            </div>
            <div class="block"></div>
            <!-- Geocoder -->
            <div class="block">
                <p>Enter an address to zoom to an area on the map, then select parcels or draw a custom shape.</p>
            </div>
        </sidebar>
        <!-- Sidebar -->
        <!-- Map -->
        <maparea id="map"></maparea>
        <!-- Map -->
    </div>

    <!-- Modal -->
    <div id="about-modal" class="modal">
    <!-- Modal Content -->
        <div class="modal-content">
            <div class="modal-header">
                <span class="close"><i class="fa fa-times" aria-hidden="true"></i></span>
                <h3>Making environmental inventory fast.</h3>
            </div>
            <div class="modal-body">
                <h4>About this tool</h4>
                <p>This map displays NJDEP Landscape Project 3.3 wildlife habitat for the state of New Jersey. Wildlife habitat is displayed as a generalized heat map at low zoom levels and detailed land-use land-cover polygons at high zoom levels.</p>
                <h4>About the data</h4>
                <p><a href="http://www.state.nj.us/dep/fgw/ensp/landscape/index.htm" target='_blank'>New Jersey Landscape Project</a> is a database that combines imperiled and priority species location information with land-use/land-cover (LULC) data. The dataset in made up of hundreds of thousands of polygons with continuous, topological coverage for the entire state and several associated tables with rich attribute information about habitat type and wildlife sighting records.</p>
                <p>Landscape Project species habitat areas are determined by running species-specific models on a wildlife observation point dataset. NJDEP ENSP biologists create habitat models for each NJ Special Concern, Threatened, and Endangered species, including Federal Threatened and Endangered species, using a combination of species biology (i.e. movement patterns, habitat preferences, home ranges, etc) and statewide LULC polygons to create potential habitat areas. <a href="https://njdep.maps.arcgis.com/apps/Cascade/index.html?appid=6cd21ef042634609904beae390f34482" target='_blank'>View the story map</a> produced by the NJDEP to learn more about Landscape Project 3.3 data.</p>
                <h4>Solving difficult problems</h4>
                <p>It can be challenging to determine a list of wildlife habitat on a specific site, even if youâ€™re in the environmental consulting/regulatory compliance world and have experience with GIS software. Other online tools that explore Landscape Project data exist, but load time is slow and retrieving lists for a user-selected area is not possible.</p>
                <p>Through the creation of this Proof of Concept we investigated a workflow to process a large dataset into vector tiles that can be rendered responsively in a web browser with <a href="https://www.mapbox.com/" target='_blank'>Mapbox</a> services and <a href="https://www.mapbox.com/mapbox-gl-js/api/" target='_blank'>Mapbox GL JS.</a></p>
                <p>Read in detail about the steps we took to create this tool in <a href="#" target='_blank'>this blog post</a> and explore other Azavea 10% Research Projects at <a href="https://www.azavea.com/research/" target='_blank'>azavea.com/research</a>.
                <h4>Future possibilities</h4>
                <p>This tool solves a specific set of problems, but it is an example of what is possible if we apply the methods used in this Proof of Concept to a similar need.</p>
                <p>What is your current process for conducting environmental inventories? If you would like to hear more about how we can help you build a tool that maximizes efficiency and accuracy for site inventories, <a href="#" target='_blank'>contact us today.</a></p>
            </div>
            <div class="modal-footer">
                <table>
                    <tbody>
                        <tr><td class="table-center"><a href="https://www.azavea.com/blog/" target="_blank"><i class="fa fa-external-link"></i></a></td><td class="table-column"><a href="https://www.azavea.com/blog/" target="_blank">learn how we built this tool</a></td></tr>
                        <tr><td class="table-center"><a href="#" target="_blank"><i class="fa fa-envelope"></i></a></td><td class="table-column"><a href="#" target="_blank">contact our team to build your own</a></td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- Modal -->
<script>

// Read-scope Mapbox Access Token for account with uploaded tile sources
const MAPBOX_ACCESS_TOKEN = 'pk.eyJ1IjoiZGFuamZvcmQiLCJhIjoiY2pheWZxZmh6MTZueTJxbmc0enlucnlnOSJ9.7sKY5s_o_0YSz0RJ6po5bQ';

mapboxgl.accessToken = MAPBOX_ACCESS_TOKEN;
var MAP = new mapboxgl.Map({
  container: 'map',
  style: 'mapbox://styles/danjford/cjayfrirx1inl2so0fa06l1ed',
  center: [-74.596258, 40.195586],
  zoom: 7.2
});

const GEOCODER = new MapboxGeocoder({
    accessToken: mapboxgl.accessToken,
    placeholder:"Type address here",
    proximity: {
        latitude: 40.195586,
        longitude: -74.596258
    }
});

document.getElementById('geocoder-container').appendChild(GEOCODER.onAdd(MAP))

MAP.addControl(new mapboxgl.NavigationControl());

const DRAW = new MapboxDraw({
  displayControlsDefault: false,
  controls: {
      polygon: true,
      trash: true
  }
});

MAP.addControl(DRAW);

</script>

  <script>
    // Get the modal
    var modal = document.getElementById('about-modal');

    // Get the button that opens the modal
    var btn = document.getElementById("modal-btn");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks the button, open the modal
    btn.onclick = function() {
        modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
        modal.style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function(event) {
        if (event.target == modal) {
            modal.style.display = "none";
        }
    }
</script>
</body>
</html>
